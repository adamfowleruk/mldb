<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: widget-dls.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: widget-dls.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>// global variable definitions
com = window.com || {};
com.marklogic = window.com.marklogic || {};
com.marklogic.widgets = window.com.marklogic.widgets || {};

// SEARCH RESULTS DECLARE ALL WIDGET









// LIST RM COLLECTIONS WIDGET -> NA Same as any collection widget - widget-collections.js


com.marklogic.widgets.dlscollections = function(container) {
  this.container = container;
  this._uriHandler = null;
  this.errorPublisher = new com.marklogic.events.Publisher(); 
  
  document.getElementById(this.container).innerHTML = "&lt;h2 class='dlscollections-title'>List of DLS Managed Collections&lt;/h2>&lt;div id='" + this.container + "-list'>&lt;i>Ready for load.&lt;/i>&lt;/div>";
};

com.marklogic.widgets.dlscollections.prototype.uriHandler = function(handler) {
  this._uriHandler = handler;
};

com.marklogic.widgets.dlscollections.prototype.refresh = function() {
  var self = this;
  mljs.defaultconnection.dlscollections(function(result) {
    var s = "";
    if (0 == result.doc.collections) {
      s += "&lt;p>&lt;i>No results&lt;/i>&lt;/p>";
    } else {
      for (var i = 0;i &lt; result.doc.collections.length;i++) {
        s += "&lt;p>";
        if (null != self._uriHandler) {
          s += "&lt;a href='" + self._uriHandler.replace("#URI#",result.doc.collections[i]) + "'>";
        }
        s += result.doc.collections[i];
        if (null != self._uriHandler) {
          s += "&lt;/a>";
        }
        s += "&lt;/p>";
      }
    }
    document.getElementById(self.container + "-list").innerHTML = s;
  });
};

/**
 * Adds an error listener to this widget
 * 
 * @param {function(error)} fl - The error listener to add
 */
com.marklogic.widgets.dlscollections.prototype.addErrorListener = function(fl) {
  this.errorPublisher.subscribe(fl);
};

/**
 * Removes an error listener
 * 
 * @param {function(error)} fl - The error listener to remove
 */
com.marklogic.widgets.dlscollections.prototype.removeErrorListener = function(fl) {
  this.errorPublisher.unsubscribe(fl);
};




// VIEW RM COLLECTION WIDGET -> NA Instead use search widget with constraint on collection URI as it's more flexible



com.marklogic.widgets.dlscollection = function(container) {
  this.container = container;
  this.errorPublisher = new com.marklogic.events.Publisher(); 
  this._uriViewHandler = null; // application document content editing/viewing handler
  this._uriInfoHandler = null; // RM / DLS view info handler
  
  document.getElementById(this.container).innerHTML = "&lt;h2 class='dlscollection-title'>Documents in DLS collection&lt;/h2>&lt;div id='" + this.container + "-list'>&lt;i>Ready for load.&lt;/i>&lt;/div>";
};

com.marklogic.widgets.dlscollection.prototype.uriViewHandler = function(handler) {
  this._uriViewHandler = handler;
};

com.marklogic.widgets.dlscollection.prototype.uriInfoHandler = function(handler) {
  this._uriInfoHandler = handler;
};

com.marklogic.widgets.dlscollection.prototype.loadCollection = function(collection) {
  var self = this;
  mljs.defaultconnection.dlscollection(collection,function(result) {
    var s = "";
    s += "&lt;p>&lt;b>Contents of collection: " + collection + "&lt;/b>&lt;/p>";
    if (0 == result.doc.uris) {
      s += "&lt;p>&lt;i>No results&lt;/i>&lt;/p>";
    } else {
      for (var i = 0;i &lt; result.doc.uris.length;i++) {
        s += "&lt;p>";
        if (null != self._uriInfoHandler) {
          s += "[&lt;a href='" + self._uriInfoHandler.replace("#URI#",result.doc.uris[i]) + "'>Info&lt;/a>] ";
        }
        if (null != self._uriViewHandler) {
          s += "[&lt;a href='" + self._uriViewHandler.replace("#URI#",result.doc.uris[i]) + "'>View&lt;/a>] ";
        }
        s += result.doc.uris[i];
        s += "&lt;/p>";
      }
    }
    document.getElementById(self.container + "-list").innerHTML = s;
  });
};


/**
 * Adds an error listener to this widget
 * 
 * @param {function(error)} fl - The error listener to add
 */
com.marklogic.widgets.dlscollection.prototype.addErrorListener = function(fl) {
  this.errorPublisher.subscribe(fl);
};

/**
 * Removes an error listener
 * 
 * @param {function(error)} fl - The error listener to remove
 */
com.marklogic.widgets.dlscollection.prototype.removeErrorListener = function(fl) {
  this.errorPublisher.unsubscribe(fl);
};







// LIST RM RETENTION RULES WIDGET


com.marklogic.widgets.dlsrules = function(container) {
  this.container = container;
  this.errorPublisher = new com.marklogic.events.Publisher(); 
  
  document.getElementById(this.container).innerHTML = "&lt;h2 class='dlsrules-title'>List of DLS Rules&lt;/h2>&lt;div id='" + this.container + "-list'>&lt;i>Ready for load.&lt;/i>&lt;/div>";
};

com.marklogic.widgets.dlsrules.prototype.uriHandler = function(handler) {
  this._uriHandler = handler;
};

com.marklogic.widgets.dlsrules.prototype.refresh = function() {
  var self = this;
  mljs.defaultconnection.dlsrules(function(result) {
    var s = "";
    if (0 == result.doc.rules.length) {
      s += "&lt;p>&lt;i>No rules exist&lt;/i>&lt;/p>";
    } else {
      for (var i = 0;i &lt; result.doc.rules.length;i++) {
        s += "&lt;p>";
        if (null != self._uriHandler) {
          s += "&lt;a href='" + self._uriHandler.replace("#URI#",result.doc.rules[i]["retentionRule"].name) + "'>";
        }
        s += result.doc.rules[i]["retentionRule"].name;
        if (null != result.doc.rules[i]["retentionRule"].comment) { 
          s += ": &lt;i>\"" + result.doc.rules[i]["retentionRule"].comment + "\"&lt;/i>";
        }
        if (null != self._uriHandler) {
          s += "&lt;/a>";
        }
        s += "&lt;/p>";
      }
    }
    document.getElementById(self.container + "-list").innerHTML = s;
  });
};


/**
 * Adds an error listener to this widget
 * 
 * @param {function(error)} fl - The error listener to add
 */
com.marklogic.widgets.dlsrules.prototype.addErrorListener = function(fl) {
  this.errorPublisher.subscribe(fl);
};

/**
 * Removes an error listener
 * 
 * @param {function(error)} fl - The error listener to remove
 */
com.marklogic.widgets.dlsrules.prototype.removeErrorListener = function(fl) {
  this.errorPublisher.unsubscribe(fl);
};








// ADD RM RETENTION RULES WIDGET

com.marklogic.widgets.dlsruleinfo = function(container) {
  this.container = container;
  this.errorPublisher = new com.marklogic.events.Publisher(); 

  this.name = null;
  
  this.refresh();
};

com.marklogic.widgets.dlsruleinfo.prototype.refresh = function() {
  if (null != this.name) {
    var self = this;
    mljs.defaultconnection.dlsrule(this.name,function(result) {
      console.log("doc content: " + JSON.stringify(result.doc));
      var s = "&lt;h2>DLS Rule Details&lt;/h2>";
      s += "&lt;b>Name: &lt;/b>" + result.doc["retentionRule"].name;
      s += "&lt;br/>&lt;b>Comment: &lt;/b>";
      if (null == result.doc["retentionRule"].comment) {
        s += "&lt;i>No comment&lt;/i>";
      } else {
        s += result.doc["retentionRule"].comment; 
      }
      s += "&lt;br/>&lt;b>Versions to keep: &lt;/b>" + result.doc["retentionRule"]["numVersions"];
      s += "&lt;br/>&lt;b>Document query summary: &lt;/b>&lt;a href='#'>" + result.doc["retentionRule"]["documentQueryText"] + "&lt;/a>";
      document.getElementById(self.container).innerHTML = s;
    });
  } else {
    var s = "&lt;h2>DLS Rule Details&lt;/h2>";
    s += "&lt;p>&lt;i>Loading...&lt;/i>&lt;/p>";
    document.getElementById(this.container).innerHTML = s;
  }
  
};

com.marklogic.widgets.dlsruleinfo.prototype.info = function(name) {
  this.name = name;
  this.refresh();
};


/**
 * Adds an error listener to this widget
 * 
 * @param {function(error)} fl - The error listener to add
 */
com.marklogic.widgets.dlsruleinfo.prototype.addErrorListener = function(fl) {
  this.errorPublisher.subscribe(fl);
};

/**
 * Removes an error listener
 * 
 * @param {function(error)} fl - The error listener to remove
 */
com.marklogic.widgets.dlsruleinfo.prototype.removeErrorListener = function(fl) {
  this.errorPublisher.unsubscribe(fl);
};


</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="com.marklogic.widgets.collectionuris.html">collectionuris</a></li><li><a href="com.marklogic.widgets.cooccurence.html">cooccurence</a></li><li><a href="com.marklogic.widgets.create.html">create</a></li><li><a href="com.marklogic.widgets.entityfacts.html">entityfacts</a></li><li><a href="com.marklogic.widgets.highcharts.html">highcharts</a></li><li><a href="com.marklogic.widgets.kratu.html">kratu</a></li><li><a href="com.marklogic.widgets.markings.html">markings</a></li><li><a href="com.marklogic.widgets.searchbar.html">searchbar</a></li><li><a href="com.marklogic.widgets.searchpage.html">searchpage</a></li><li><a href="com.marklogic.widgets.searchpager.html">searchpager</a></li><li><a href="com.marklogic.widgets.searchresults.html">searchresults</a></li><li><a href="com.marklogic.widgets.searchsort.html">searchsort</a></li><li><a href="com.marklogic.widgets.sparqlbar.html">sparqlbar</a></li><li><a href="com.marklogic.widgets.sparqlresults.html">sparqlresults</a></li><li><a href="com.marklogic.widgets.tripleconfig.html">tripleconfig</a></li></ul><h3>Namespaces</h3><ul><li><a href="com.marklogic.widgets.bits.html">bits</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-all.html">all</a></li><li><a href="tutorial-browser-create-app.html">browser-create-app</a></li><li><a href="tutorial-samples.html">samples</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0-dev</a> on Wed Jul 24 2013 23:28:06 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
